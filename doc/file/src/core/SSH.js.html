<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/core/SSH.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">actions</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-addRecent">addRecent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-closeFile">closeFile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fetchRecent">fetchRecent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-load">load</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-newFile">newFile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-openFile">openFile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-openFilePassword">openFilePassword</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-save">save</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-add">add</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-clear">clear</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-collapse">collapse</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-add">add</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-edit">edit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fetch">fetch</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-handleSSHTerminal">handleSSHTerminal</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-loadConfigFromServer">loadConfigFromServer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-loadConfigTextArea">loadConfigTextArea</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-preview">preview</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-rebootServer">rebootServer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-reuploadConfig">reuploadConfig</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setup">setup</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setupFailure">setupFailure</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setupSuccess">setupSuccess</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-updateStatus">updateStatus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-vpnAction">vpnAction</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-add">add</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-downloadConfiguration">downloadConfiguration</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-edit">edit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fetch">fetch</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-remove">remove</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setupAllClients">setupAllClients</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setupClient">setupClient</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/authorization</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Authorization">Authorization</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-LoginWrapper">LoginWrapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-RecentFiles">RecentFiles</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/form</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Actions">Actions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Checkbox">Checkbox</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Error">Error</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-File">File</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Input">Input</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Label">Label</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Radio">Radio</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Select">Select</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/logs</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/logs/LogItem.jsx~LogItem.html">LogItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Logs">Logs</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/servers</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AddServerButton">AddServerButton</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ServerList">ServerList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ServerListItem">ServerListItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ServerShowContent">ServerShowContent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ServerShowContentRow">ServerShowContentRow</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/servers/fields</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AllowSubnetFields">AllowSubnetFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AssignSpecificIpFields">AssignSpecificIpFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-BridgingModeFields">BridgingModeFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-CertificateInformationFields">CertificateInformationFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-IpAddressFields">IpAddressFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-normalizeIpAddress">normalizeIpAddress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-KeepAliveFields">KeepAliveFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-RedirectGatewayFields">RedirectGatewayFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-RoutesFields">RoutesFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ServerInformationFields">ServerInformationFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ServerModeFields">ServerModeFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-VpnConfigurationFields">VpnConfigurationFields</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/users</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-UserList">UserList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-UserListItem">UserListItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-UserWarning">UserWarning</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">constants</div><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CLEAR_STATE">CLEAR_STATE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CLOSE">CLOSE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-FETCH_RECENT">FETCH_RECENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LOAD_FAILURE">LOAD_FAILURE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LOAD_SUCCESS">LOAD_SUCCESS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-NEW">NEW</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-OPEN">OPEN</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SAVE_FAILURE">SAVE_FAILURE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SAVE_SUCCESS">SAVE_SUCCESS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CIPHER_ALGORITHM">CIPHER_ALGORITHM</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-COUNTRY">COUNTRY</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DEV">DEV</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-GROUP_PRIVILEGE">GROUP_PRIVILEGE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LEARN_ADDRESS">LEARN_ADDRESS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LOCAL_IP_ADDRESS">LOCAL_IP_ADDRESS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-MAX_CLIENTS">MAX_CLIENTS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-MUTE">MUTE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PORT">PORT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PROTOCOL">PROTOCOL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TLS_AUTH">TLS_AUTH</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TOPOLOGY">TOPOLOGY</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-USER_PRIVILEGE">USER_PRIVILEGE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ADD">ADD</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CLEAR">CLEAR</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LEVEL">LEVEL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TOGGLE_COLLAPSE">TOGGLE_COLLAPSE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ADD_SUCCESS">ADD_SUCCESS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AUTH_OPTIONS">AUTH_OPTIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CIPHER_OPTIONS">CIPHER_OPTIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DEFAULT_SERVER_CONFIG">DEFAULT_SERVER_CONFIG</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DEFAULT_SERVER_STATUS">DEFAULT_SERVER_STATUS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DEV_OPTIONS">DEV_OPTIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EDIT_SUCCESS">EDIT_SUCCESS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-FETCH">FETCH</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LOG_LEVEL_OPIONS">LOG_LEVEL_OPIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-MODE">MODE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PROTOCOL_OPTIONS">PROTOCOL_OPTIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SETUP">SETUP</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SETUP_FAILURE">SETUP_FAILURE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SETUP_SUCCESS">SETUP_SUCCESS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STATUS">STATUS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STATUS_CHANGE">STATUS_CHANGE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STATUS_FETCH_START">STATUS_FETCH_START</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TOPOLOGY_OPTIONS">TOPOLOGY_OPTIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-UPDATE_CONFIG">UPDATE_CONFIG</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-UPDATE_SERVER_STATUS_CACHE_TIME">UPDATE_SERVER_STATUS_CACHE_TIME</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-YES_NO_OPTIONS">YES_NO_OPTIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ADD">ADD</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DOWNLOAD">DOWNLOAD</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EDIT">EDIT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-FETCH">FETCH</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-REMOVE">REMOVE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SETUP">SETUP</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SETUP_FAILURE">SETUP_FAILURE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SETUP_SUCCESS">SETUP_SUCCESS</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">containers</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-App">App</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">containers/home</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Home">Home</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">containers/servers/status</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ServerStatusItem">ServerStatusItem</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">core</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/ConfigurationGenerator.js~ConfigurationGenerator.html">ConfigurationGenerator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/ConfigurationReader.js~ConfigurationReader.html">ConfigurationReader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/Encryption.js~Encryption.html">Encryption</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/SSH.js~SSH.html">SSH</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/SSHStats.js~SSHStats.html">SSHStats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-deleteInstance">deleteInstance</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">reducers</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-authorization">authorization</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-logs">logs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-menu">menu</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-servers">servers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-users">users</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">selectors</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getFileMap">getFileMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getLogsCollapsed">getLogsCollapsed</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getLogsList">getLogsList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-canOpenTerminal">canOpenTerminal</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getServerFetchStatusMap">getServerFetchStatusMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getServerStatusMap">getServerStatusMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getServersMap">getServersMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getSetupInProgressMap">getSetupInProgressMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getSetupInProgressMap">getSetupInProgressMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getRecentFiles">getRecentFiles</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isFileOpen">isFileOpen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getLogsArray">getLogsArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getFormSelector">getFormSelector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getPreview">getPreview</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getServer">getServer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getServerArray">getServerArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getServerFetchStatus">getServerFetchStatus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getServerStatus">getServerStatus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getSetupInProgress">getSetupInProgress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getUser">getUser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getUsersArray">getUsersArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getUsersMap">getUsersMap</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">store</div><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-history">history</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-store">store</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-compileMessage">compileMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-email">email</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ipAddress">ipAddress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-maxValue">maxValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-minLength">minLength</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-minValue">minValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-required">required</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validateServer">validateServer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validateUser">validateUser</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/core/SSH.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import NodeSSH from &apos;node-ssh&apos;;
import fs from &apos;fs&apos;;
import { remote } from &apos;electron&apos;;
import { swal } from &apos;react-redux-sweetalert&apos;;
import { add as addLog } from &apos;../actions/logs&apos;;
import * as LOG from &apos;../constants/logs&apos;;
import SSHStats from &apos;./SSHStats&apos;;
import ConfigurationGenerator from &apos;./ConfigurationGenerator&apos;;

const certDirectory = &apos;~/openvpn-ca&apos;;
const varsFile = `${certDirectory}/vars`;
const certBegin = `cd ${certDirectory} &amp;&amp; source ${varsFile}`;

const cleanAll = `${certDirectory}/clean-all`;
const buildCa = `${certDirectory}/pkitool --initca`;
const buildKeyServer = `${certBegin} &amp;&amp; ${certDirectory}/pkitool --batch --server server`;

const buildDh = `${certBegin} &amp;&amp; ${certDirectory}/build-dh`;
const buildHmac = `openvpn --genkey --secret ${certDirectory}/keys/ta.key`;
const allKeys = &apos;ca.crt ca.key server.crt server.key ta.key dh2048.pem&apos;;
const copyKeys = `cd ${certDirectory}/keys &amp;&amp; sudo cp ${allKeys} /etc/openvpn`;
const checkKeys = `cd ${certDirectory}/keys &amp;&amp; ls ${allKeys}`;


const generateClientKey = `${certDirectory}/pkitool --batch`;
const confFile = &apos;/etc/openvpn/server.conf&apos;;
const clientKeysDir = &apos;~/openvpn-ca/keys&apos;;
const clientOutputDir = &apos;~/client-configs/files&apos;;
const ccdDir = &apos;/etc/openvpn/ccd&apos;; // it should be able to reassigned by server configuration

export default class SSH {
    constructor(dispatch, server) {
        this.dispatch = dispatch;
        this.server = server;
        this.ssh = new NodeSSH();

        this.config = {
            host: server.host,
            port: server.port,
            username: server.username,
        };

        if (server.key) {
            this.config.privateKey = fs.readFileSync(server.key, &apos;utf-8&apos;, &apos;r&apos;);
        }

        if (server.password) {
            this.config.password = server.password;
        }

        this.sudoPasswordRequired = false;

        this.connection = this.ssh.connect(this.config)
            .catch(e =&gt; Promise.reject(this.defaultError(e)))
            .then(() =&gt; this.determineSudoPasswordNeeded());

        this.statistics = new SSHStats(this, dispatch);
    }

    determineSudoPasswordNeeded() {
        return this.runCommand(&apos;sudo -n true&apos;).then(() =&gt; null).catch((e) =&gt; {
            if (e.stderr.indexOf(&apos;password is required&apos;) !== -1) {
                // Got sudo access but password is required
                this.sudoPasswordRequired = true;
                return this.runCommand(`echo &quot;${this.config.password}&quot; | sudo -S -v`)
                    .then(() =&gt; null)
                    .catch(error =&gt; Promise.reject(this.defaultError(error)));
            }
            return Promise.reject(this.defaultError(e));
        });
    }

    log(msg, level) {
        this.dispatch(addLog(msg, level, &apos;SSH&apos;));
    }

    setupServer() {
        this.log(&apos;Starting setup_server&apos;, LOG.LEVEL.INFO);

        return new Promise((resolve, reject) =&gt; {
            this.connection
                .then(() =&gt; this.aptGetUpdate()
                    .then(() =&gt; this.aptGetInstall())
                    .then(() =&gt; this.makeCADir())
                    .then(() =&gt; this.configureCAVars())
                    .then(() =&gt; this.generateServerKeys())
                    .then(() =&gt; this.copyKeys())
                    .then(() =&gt; this.uploadServerConfig())
                    .then(() =&gt; this.enableIpForward())
                    .then(() =&gt; this.configureFirewall())
                    .then(() =&gt; this.restartVpn())
                    .then(() =&gt; this.setupClientInfrastructure())
                    .then(resolve)
                    .catch((e) =&gt; {
                        this.log(&apos;Something failed...&apos;, LOG.LEVEL.ERROR);
                        this.log(e, LOG.LEVEL.ERROR);
                        reject(e);
                    }))
                .catch(e =&gt; reject(e));
        });
    }

    uploadConfig() {
        return new Promise((resolve, reject) =&gt; {
            this.connection
                .then(() =&gt; this.uploadServerConfig()
                    .then(() =&gt; this.restartVpn())
                    .then(resolve)
                    .catch((e) =&gt; {
                        this.log(&apos;Something failed...&apos;, LOG.LEVEL.ERROR);
                        this.log(e, LOG.LEVEL.ERROR);
                        reject(e);
                    }))
                .catch(e =&gt; reject(e));
        });
    }

    setupClient({ id, ipAddress, config }) {
        this.log(&apos;Starting setup_client&apos;, LOG.LEVEL.INFO);

        return new Promise((resolve, reject) =&gt; {
            const checkUserFilesCommand = `ls ${clientKeysDir}/${id}.key &amp;&amp; ls ${clientKeysDir}/${id}.crt &amp;&amp; ls ${clientKeysDir}/${id}.csr`;
            this.connection
                .then(() =&gt; this.runCommand(checkUserFilesCommand, {}, false)
                    .then((response) =&gt; {
                        if (response.code === 0) {
                            // Cert with given name exists
                            this.log(`Key with name ${id} already exists`, LOG.LEVEL.WARNING);
                            return new Promise((responseResolve, responseReject) =&gt; {
                                this.dispatch(swal({
                                    title: &apos;Key exists&apos;,
                                    type: &apos;warning&apos;,
                                    confirmButtonText: &apos;Yes&apos;,
                                    cancelButtonText: &apos;No&apos;,
                                    text: `Key with name ${id} already exists. Do you want to regenerate it?`,
                                    showCancelButton: true,
                                    closeOnConfirm: true,
                                    onConfirm: () =&gt; responseResolve(response),
                                    onCancel: () =&gt; responseReject(response),
                                    allowOutsideClick: true,
                                    onOutsideClick: () =&gt; responseReject(response),
                                    onEscapeKey: () =&gt; responseReject(response),
                                }));
                            }).then(() =&gt; this.runCommand(`rm ${clientKeysDir}/${id}.key`)
                                .then(() =&gt; this.removeCrtFromDB(id))
                                .then(() =&gt; this.generateClientKey(id))
                                .then(() =&gt; this.generateClientConfigFiles(id, config))
                                .then(() =&gt; this.bindClientIp(id, ipAddress)))
                            // eslint-disable-next-line arrow-body-style
                            .catch(() =&gt; {
                                // eslint-disable-next-line arrow-body-style
                                return this.runCommand(`ls ${clientOutputDir}/${id}.ovpn`).then(() =&gt; {
                                    return this.shouldRegenerateOvpn(response)
                                        .then(() =&gt; this.generateClientConfigFiles(id, config))
                                        .catch(() =&gt; {});
                                }).catch(() =&gt; {});
                            });
                        } else if (response.code === 2) {
                            // Cert not exist
                            return this.generateClientKey(id)
                                .then(() =&gt; this.generateClientConfigFiles(id, config)
                                .then(() =&gt; this.bindClientIp(id, ipAddress)));
                        }
                        throw response;
                    }))
                .then(() =&gt; this.restartVpn())
                .then(resolve)
                .catch((e) =&gt; {
                    this.log(&apos;Something failed...&apos;, LOG.LEVEL.ERROR);
                    this.log(e, LOG.LEVEL.ERROR);
                    reject(e);
                });
        });
    }

    shouldRegenerateOvpn(response) {
        return new Promise((resolve, reject) =&gt; {
            setTimeout(() =&gt; this.dispatch(swal({
                title: &apos;Key exists&apos;,
                type: &apos;warning&apos;,
                confirmButtonText: &apos;Yes&apos;,
                cancelButtonText: &apos;No&apos;,
                text: &apos;Do you want to regenerate ovpn file??&apos;,
                showCancelButton: true,
                closeOnConfirm: true,
                onConfirm: () =&gt; resolve(response),
                onCancel: () =&gt; reject(response),
                allowOutsideClick: true,
                onOutsideClick: () =&gt; reject(response),
                onEscapeKey: () =&gt; reject(response),
            })), 200);
        });
    }

    deleteClientFiles({ id }) {
        return new Promise((resolve, reject) =&gt; {
            this.connection
                .then(() =&gt; this.runCommand(
                    `rm -rf ${clientKeysDir}/${id}.key ${clientOutputDir}/${id}.ovpn ${clientKeysDir}/${id}.crt`,
                ))
                .then(() =&gt; this.removeCrtFromDB(id))
                .then(() =&gt; this.restartVpn())
                .then(resolve)
                .catch((e) =&gt; {
                    this.log(&apos;Something failed...&apos;, LOG.LEVEL.ERROR);
                    this.log(e, LOG.LEVEL.ERROR);
                    reject(e);
                });
        });
    }

    generateServerKeys() {
        return this.runCommand(`${checkKeys}`, {}, false).then((response) =&gt; {
            if (response.code === 0) {
                return new Promise((resolve, reject) =&gt; {
                    this.dispatch(swal({
                        title: &apos;Key exists&apos;,
                        confirmButtonText: &apos;Yes&apos;,
                        cancelButtonText: &apos;No&apos;,
                        type: &apos;warning&apos;,
                        text: &apos;Server keys already exists. &apos; +
                        &apos;Do you want to regenerate them? &apos; +
                        &apos;Please note that this action will erase all server and client keys from the server and &apos; +
                        &apos;this action cannot be undone&apos;,
                        showCancelButton: true,
                        closeOnConfirm: true,
                        onConfirm: () =&gt; resolve(response),
                        onCancel: () =&gt; reject(response),
                        allowOutsideClick: true,
                        onOutsideClick: () =&gt; reject(response),
                        onEscapeKey: () =&gt; reject(response),
                    }));
                }).then(() =&gt; this.generateAllServerKeys()).catch(keysResponse =&gt; keysResponse);
            }
            return this.generateAllServerKeys();
        });
    }

    generateAllServerKeys() {
        return this.cleanAll()
            .then(() =&gt; this.buildCA())
            .then(() =&gt; this.buildKeyServer())
            .then(() =&gt; this.buildDH())
            .then(() =&gt; this.buildHMAC());
    }

    generateClientKey(id) {
        return this.runCommand(
            `${certBegin} &amp;&amp; ${generateClientKey} ${id}`,
        );
    }

    removeCrtFromDB(id) {
        return this.runCommand(
            `sed -i &apos;/CN=${id}/d&apos; ${clientKeysDir}/index.txt`,
        );
    }

    generateClientConfigFiles(id, userConfig) {
        return this.runCommand(
            `cat /dev/null \
            &lt;(echo -e &apos;${this.generateClientConfig(userConfig)}&apos;) \
            &lt;(echo -e &apos;&lt;ca&gt;&apos;) \
            ${clientKeysDir}/ca.crt \
            &lt;(echo -e &apos;&lt;/ca&gt;\n&lt;cert&gt;&apos;) \
            ${clientKeysDir}/${id}.crt \
            &lt;(echo -e &apos;&lt;/cert&gt;\n&lt;key&gt;&apos;) \
            ${clientKeysDir}/${id}.key \
            &lt;(echo -e &apos;&lt;/key&gt;\n&lt;tls-auth&gt;&apos;) \
            ${clientKeysDir}/ta.key \
            &lt;(echo -e &apos;&lt;/tls-auth&gt;&apos;) \
            &gt; ${clientOutputDir}/${id}.ovpn`,
        );
    }

    bindClientIp(id, ipAddress) {
        return this.runCommand(
            `sudo mkdir -p ${ccdDir} &amp;&amp; sudo touch ${ccdDir}/${id} &amp;&amp; echo &quot;${ipAddress} ${SSH.nextIpAddress(ipAddress)}&quot; | sudo tee ${ccdDir}/${id}`,
        );
    }

    static nextIpAddress(ipAddress) {
        const sections = ipAddress.split(&apos;.&apos;);
        sections[3] = +(sections[3]) + 1;
        return sections.join(&apos;.&apos;);
    }

    defaultError(e) {
        this.log(e, LOG.LEVEL.ERROR);
        return e;
    }

    defaultSuccess(response, errorOnNonZero = true) {
        if (errorOnNonZero &amp;&amp; response.code !== 0) {
            return Promise.reject(response);
        }

        if (response.code !== 0) {
            this.log(response, LOG.LEVEL.WARNING);
        } else {
            this.log(response, LOG.LEVEL.INFO);
        }

        return response;
    }

    runCommand(command, params = {}, errorOnNonZero = true) {
        const logTime = (t0) =&gt; {
            const time = (performance.now() - t0) / 1000;
            this.log(`${command} has finished, took: ${time} seconds`, LOG.LEVEL.INFO);
            return time;
        };

        const t0 = performance.now();

        this.log(`${command} has started`, LOG.LEVEL.INFO);

        let finalCommand = command;
        if (this.sudoPasswordRequired &amp;&amp; command.indexOf(&apos;sudo&apos;) !== -1) {
            finalCommand = `echo &quot;${this.config.password}&quot; | sudo -S -v &amp;&amp; ${command}`
        }

        return this.ssh.execCommand(finalCommand, params)
            .then(response =&gt; ({ ...response, command, command_time: logTime(t0) }))
            .catch(e =&gt; this.defaultError(e))
            .then(response =&gt; this.defaultSuccess(response, errorOnNonZero));
    }

    ls() {
        return this.runCommand(`ls -al ${certDirectory}`);
    }

    aptGetUpdate() {
        return this.runCommand(&apos;sudo apt-get update&apos;);
    }

    aptGetInstall() {
        return this.runCommand(&apos;sudo apt-get install openvpn easy-rsa -y&apos;);
    }

    makeCADir() {
        return this.runCommand(`make-cadir ${certDirectory}`, {}, false).then((response) =&gt; {
            if (response.code === 0) {
                return response;
            } else if (response.code === 1 &amp;&amp; response.stdout.includes(&apos;openvpn-ca exists&apos;)) {
                this.log(`Directory ${certDirectory} exists, omitting`, LOG.LEVEL.INFO);
                return response;
            }
            return Promise.reject(response);
        });
    }

    setCAVar(key, value) {
        return `sed -i &apos;s/${key}=&quot;.*&quot;/${key}=&quot;${value || &apos;&apos;}&quot;/&apos; ${varsFile}`;
    }

    configureCAVars() {
        const run = command =&gt; this.runCommand(command);
        const server = this.server;

        return this.runCommand(this.setCAVar(&apos;KEY_NAME&apos;, &apos;server&apos;))
            .then(() =&gt; run(this.setCAVar(&apos;KEY_COUNTRY&apos;, server.country)))
            .then(() =&gt; run(this.setCAVar(&apos;KEY_PROVINCE&apos;, server.province)))
            .then(() =&gt; run(this.setCAVar(&apos;KEY_CITY&apos;, server.city)))
            .then(() =&gt; run(this.setCAVar(&apos;KEY_ORG&apos;, server.org)))
            .then(() =&gt; run(this.setCAVar(&apos;KEY_EMAIL&apos;, server.email)))
            .then(() =&gt; run(this.setCAVar(&apos;KEY_OU&apos;, server.ou)));
    }

    setCaCommonNameVar() {
        return this.runCommand(`cat ${varsFile}`).then((response) =&gt; {
            if (response.stdout.match(/^export KEY_CN=&quot;.*&quot;/gm)) {
                return this.runCommand(this.setCAVar(&apos;KEY_CN&apos;, &apos;server&apos;));
            } else {
                return this.runCommand(`echo &apos;export KEY_CN=&quot;server&quot;&apos; &gt;&gt; ${varsFile}`);
            }
        });
    }

    cleanAll() {
        return this.runCommand(
            `${certBegin} &amp;&amp; ${cleanAll}`,
        );
    }

    buildCA() {
        return this.runCommand(
            `${certBegin} &amp;&amp; ${buildCa}`,
        );
    }

    buildKeyServer() {
        return this.runCommand(
            `${buildKeyServer}`,
        );
    }

    buildDH() {
        return this.runCommand(
            `${buildDh}`,
        );
    }

    buildHMAC() {
        return this.runCommand(
            `${buildHmac}`,
        );
    }

    copyKeys() {
        return this.runCommand(
            `${copyKeys}`,
        );
    }

    enableIpForward() {
        return this.runCommand(
            // eslint-disable-next-line no-useless-escape
            &apos;sudo sed -i -r \&apos;s/#?net\.ipv4\.ip_forward\=.*/net\.ipv4\.ip_forward=1/\&apos; /etc/sysctl.conf &amp;&amp; sudo sysctl -p&apos;,
        );
    }

    configureFirewall() {
        let interfaceName = &apos;&apos;;
        return this.runCommand(&apos;ip route | grep default&apos;).then((response) =&gt; {
            interfaceName = response.stdout.split(&apos; &apos;);
            interfaceName = interfaceName[4];

            if (!interfaceName) {
                throw Error(&apos;Could not find interface name&apos;);
            }

            const command = `*nat\n:POSTROUTING ACCEPT [0:0]\n-A POSTROUTING -s 10.8.0.0/8 -o ${interfaceName} -j MASQUERADE\nCOMMIT\n`;

            return this.runCommand(&apos;sudo cat /etc/ufw/before.rules&apos;).then((catResponse) =&gt; {
                const data = catResponse.stdout;
                if (data.indexOf(command) !== -1) {
                    return;
                }
                return this.runCommand(`echo &quot;${command}\n${data}&quot; | sudo tee /etc/ufw/before.rules`);
            });
        })
            .then(() =&gt; this.runCommand(&apos;sudo sed -i \&apos;s/DEFAULT_FORWARD_POLICY=&quot;.*&quot;/DEFAULT_FORWARD_POLICY=&quot;ACCEPT&quot;/\&apos; /etc/default/ufw&apos;))
            .then(() =&gt; this.runCommand(`sudo ufw allow ${this.server.config.port}/${this.server.config.protocol}`))
            .then(() =&gt; this.runCommand(&apos;sudo ufw allow OpenSSH&apos;))
            .then(() =&gt; this.runCommand(&apos;sudo ufw disable &amp;&amp; sudo ufw --force enable&apos;)); // force is needed for non-interactive mode
    }

    setupClientInfrastructure() {
        return this.runCommand(
            &apos;mkdir -p ~/client-configs/files &amp;&amp; chmod 700 ~/client-configs/files&apos;);
    }

    uploadServerConfig() {
        const configContent = this.generateServerConfig();
        return this.runCommand(
            `echo &quot;${configContent}&quot; | sudo tee ${confFile}`,
        );
    }

    generateServerConfig() {
        return ConfigurationGenerator.generate(this.server.config);
    }

    generateClientConfig(userConfig) {
        const server = this.server;
        const config = this.server.config;
        return ConfigurationGenerator.generateUser(config, server, userConfig);
    }

    downloadConfiguration({ id }) {
        return new Promise((resolve, reject) =&gt; {
            this.connection
                .then(() =&gt; {
                    const filePath = `${clientOutputDir}/${id}.ovpn`;
                    return this.runCommand(`ls ${filePath}`, {}, false)
                        .then((response) =&gt; {
                            if (response.code === 0) {
                                return this.downloadConfigFile(filePath, id, reject);
                            } else if (response.code === 2) {
                                return reject(&apos;File does not exists&apos;);
                            }
                            return reject(response);
                        });
                })
                .then(resolve)
                .catch((e) =&gt; {
                    this.log(&apos;Something failed...&apos;, LOG.LEVEL.ERROR);
                    this.log(e, LOG.LEVEL.ERROR);
                    reject(e);
                });
        });
    }

    downloadConfigFile(filePath, id, reject) {
        return this.runCommand(`readlink -f ${filePath}`).then((response) =&gt; {
            const absoluteFilePath = response.stdout;
            const filename = remote.dialog.showSaveDialog(
                remote.getCurrentWindow(),
                {
                    defaultPath: `${id}.ovpn`,
                },
            );

            return this.ssh.getFile(filename, absoluteFilePath);
        }).catch(e =&gt; reject(e));
    }

    getConfigFromServer() {
        return this.catFile(confFile);
    }

    catFile(path) {
        return this.connection.then(() =&gt; this.runCommand(`cat ${path}`));
    }

    reboot() {
        return this.runCommand(&apos;sudo reboot&apos;);
    }

    startVpn() {
        return this.runCommand(&apos;sudo systemctl start openvpn@server&apos;)
            .then(() =&gt; this.runCommand(&apos;sudo systemctl status openvpn@server&apos;))
            .then(() =&gt; this.runCommand(&apos;sudo systemctl enable openvpn@server&apos;));
    }

    stopVpn() {
        return this.runCommand(&apos;sudo systemctl stop openvpn@server&apos;);
    }

    restartVpn() {
        return this.runCommand(&apos;sudo systemctl restart openvpn@server&apos;)
            .then(() =&gt; this.runCommand(&apos;sudo systemctl status openvpn@server&apos;));
    }

    runAction(action) {
        return this.connection.then(() =&gt; this[action]());
    }
}

</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
